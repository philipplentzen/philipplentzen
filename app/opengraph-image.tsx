import { ImageResponse } from "next/og";

async function loadGoogleFont(font: string) {
  const url = `https://fonts.googleapis.com/css2?family=${font}`;
  const css = await (await fetch(url)).text();
  const resource = css.match(
    /src: url\((.+)\) format\('(opentype|truetype)'\)/,
  );

  if (resource) {
    const response = await fetch(resource[1]);
    if (response.status == 200) {
      return await response.arrayBuffer();
    }
  }

  throw new Error("failed to load font data");
}

export const size = {
  width: 1200,
  height: 630,
};

export const contentType = "image/png";

export default async function Image() {
  return new ImageResponse(
    (
      <div
        style={{
          fontSize: 72,
          backgroundColor: "#f5faff",
          backgroundImage:
            "radial-gradient(at 10% 10%, rgba(24,170,153, 0.3) 0%, rgba(252,186,3, 0.1) 100%);",
          color: "0f1e29",
          width: "100%",
          height: "100%",
          display: "flex",
          flexDirection: "column",
          justifyContent: "space-between",
          padding: "64px",
          lineHeight: "0.9",
        }}
      >
        <svg
          viewBox="0 0 341 56"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          fill="currentColor"
          style={{ width: "389.71", height: "64px", marginBottom: "16px" }}
        >
          <path d="M0 56V12.7741H7.54348V15.0443C9.23321 13.0465 11.4963 12.0476 14.3326 12.0476C16.9678 12.0476 19.2409 12.7034 21.1519 14.0151C23.0629 15.3067 24.5314 17.1632 25.5573 19.5849C26.5832 22.0065 27.0962 24.8923 27.0962 28.2422C27.0962 31.4912 26.5631 34.3366 25.4969 36.7784C24.4308 39.2 22.9322 41.0868 21.001 42.4389C19.0699 43.7708 16.8169 44.4368 14.2421 44.4368C12.834 44.4368 11.5667 44.1845 10.4402 43.68C9.31368 43.1553 8.34811 42.3885 7.54348 41.3795V52.5795L0 56ZM13.1256 37.2022C15.1775 37.2022 16.7566 36.4252 17.863 34.8713C18.9693 33.2973 19.5225 31.0876 19.5225 28.2422C19.5225 25.3968 18.9593 23.187 17.8328 21.613C16.7063 20.0389 15.1372 19.2519 13.1256 19.2519C11.8986 19.2519 10.8224 19.4739 9.89704 19.9178C8.99182 20.3618 8.2073 21.0378 7.54348 21.9459V34.4476C8.08661 35.3153 8.85101 35.9914 9.83669 36.4757C10.8425 36.96 11.9388 37.2022 13.1256 37.2022Z" />
          <path d="M30.0608 43.7103V3.48108L37.6042 0V15.7708C38.5899 14.5196 39.7667 13.5914 41.1346 12.9859C42.5226 12.3604 44.1017 12.0476 45.8719 12.0476C48.2456 12.0476 50.227 12.5521 51.8161 13.5611C53.4254 14.5499 54.6324 15.9726 55.437 17.8292C56.2416 19.6656 56.644 21.8652 56.644 24.4281V43.7103H49.1307V26.7589C49.1307 24.2162 48.6982 22.3294 47.8332 21.0984C46.9682 19.8674 45.5601 19.2519 43.6088 19.2519C41.557 19.2519 40.0383 19.8573 39.0526 21.0681C38.087 22.2587 37.6042 24.1153 37.6042 26.6378V43.7103H30.0608Z" />
          <path d="M61.0069 43.7103V12.7741H68.5504V43.7103H61.0069ZM64.7787 8.89946C63.5717 8.89946 62.5257 8.46559 61.6406 7.59784C60.7756 6.70991 60.3431 5.66054 60.3431 4.44973C60.3431 3.23892 60.7756 2.20973 61.6406 1.36216C62.5056 0.494417 63.5516 0.0605434 64.7787 0.0605434C66.046 0.0605434 67.1021 0.484326 67.9469 1.33189C68.7918 2.17946 69.2142 3.21874 69.2142 4.44973C69.2142 5.68072 68.7817 6.73009 67.9167 7.59784C67.0719 8.46559 66.0258 8.89946 64.7787 8.89946Z" />
          <path d="M73.5112 43.7103V3.42054L81.0546 0V43.7103H73.5112Z" />
          <path d="M86.0041 43.7103V12.7741H93.5476V43.7103H86.0041ZM89.7758 8.89946C88.5689 8.89946 87.5229 8.46559 86.6378 7.59784C85.7728 6.70991 85.3403 5.66054 85.3403 4.44973C85.3403 3.23892 85.7728 2.20973 86.6378 1.36216C87.5028 0.494417 88.5488 0.0605434 89.7758 0.0605434C91.0432 0.0605434 92.0992 0.484326 92.9441 1.33189C93.789 2.17946 94.2114 3.21874 94.2114 4.44973C94.2114 5.68072 93.7789 6.73009 92.9139 7.59784C92.0691 8.46559 91.023 8.89946 89.7758 8.89946Z" />
          <path d="M98.2066 56V12.7741H105.75V15.0443C107.44 13.0465 109.703 12.0476 112.539 12.0476C115.174 12.0476 117.448 12.7034 119.359 14.0151C121.27 15.3067 122.738 17.1632 123.764 19.5849C124.79 22.0065 125.303 24.8923 125.303 28.2422C125.303 31.4912 124.77 34.3366 123.704 36.7784C122.637 39.2 121.139 41.0868 119.208 42.4389C117.277 43.7708 115.024 44.4368 112.449 44.4368C111.041 44.4368 109.773 44.1845 108.647 43.68C107.52 43.1553 106.555 42.3885 105.75 41.3795V52.5795L98.2066 56ZM111.332 37.2022C113.384 37.2022 114.963 36.4252 116.07 34.8713C117.176 33.2973 117.729 31.0876 117.729 28.2422C117.729 25.3968 117.166 23.187 116.039 21.613C114.913 20.0389 113.344 19.2519 111.332 19.2519C110.105 19.2519 109.029 19.4739 108.104 19.9178C107.198 20.3618 106.414 21.0378 105.75 21.9459V34.4476C106.293 35.3153 107.058 35.9914 108.043 36.4757C109.049 36.96 110.145 37.2022 111.332 37.2022Z" />
          <path d="M127.678 56V12.7741H135.222V15.0443C136.911 13.0465 139.174 12.0476 142.011 12.0476C144.646 12.0476 146.919 12.7034 148.83 14.0151C150.741 15.3067 152.209 17.1632 153.235 19.5849C154.261 22.0065 154.774 24.8923 154.774 28.2422C154.774 31.4912 154.241 34.3366 153.175 36.7784C152.109 39.2 150.61 41.0868 148.679 42.4389C146.748 43.7708 144.495 44.4368 141.92 44.4368C140.512 44.4368 139.245 44.1845 138.118 43.68C136.992 43.1553 136.026 42.3885 135.222 41.3795V52.5795L127.678 56ZM140.804 37.2022C142.856 37.2022 144.435 36.4252 145.541 34.8713C146.647 33.2973 147.201 31.0876 147.201 28.2422C147.201 25.3968 146.637 23.187 145.511 21.613C144.384 20.0389 142.815 19.2519 140.804 19.2519C139.577 19.2519 138.5 19.4739 137.575 19.9178C136.67 20.3618 135.885 21.0378 135.222 21.9459V34.4476C135.765 35.3153 136.529 35.9914 137.515 36.4757C138.521 36.96 139.617 37.2022 140.804 37.2022Z" />
          <path d="M168.3 43.7103V3.42054L175.843 0V43.7103H168.3Z" />
          <path d="M193.435 44.4368C190.478 44.4368 187.924 43.7708 185.771 42.4389C183.639 41.107 181.99 39.2303 180.823 36.8086C179.676 34.3668 179.103 31.5013 179.103 28.2119C179.103 24.8822 179.686 22.0065 180.853 19.5849C182.04 17.1632 183.699 15.3067 185.832 14.0151C187.984 12.7034 190.519 12.0476 193.435 12.0476C195.93 12.0476 198.193 12.5723 200.225 13.6216C202.256 14.671 203.876 16.2854 205.083 18.4649C206.29 20.6241 206.893 23.3787 206.893 26.7286C206.893 27.2533 206.873 27.8991 206.833 28.6659C206.813 29.4126 206.762 30.1694 206.682 30.9362H186.556C186.636 32.3488 186.958 33.5899 187.521 34.6595C188.105 35.7088 188.899 36.5261 189.905 37.1114C190.911 37.6966 192.098 37.9892 193.466 37.9892C194.934 37.9892 196.211 37.747 197.298 37.2627C198.384 36.7582 199.41 35.9611 200.375 34.8713L204.721 39.3816C203.393 40.8951 201.794 42.116 199.923 43.0443C198.052 43.9726 195.89 44.4368 193.435 44.4368ZM186.586 25.0335H199.591C199.49 23.6814 199.189 22.5211 198.686 21.5524C198.183 20.5636 197.479 19.8068 196.574 19.2822C195.668 18.7575 194.572 18.4951 193.285 18.4951C191.514 18.4951 190.006 19.04 188.759 20.1297C187.511 21.2195 186.787 22.8541 186.586 25.0335Z" />
          <path d="M209.673 43.7103V12.7741H217.217V15.7405C218.202 14.5096 219.379 13.5914 220.747 12.9859C222.135 12.3604 223.714 12.0476 225.484 12.0476C228.924 12.0476 231.58 13.1171 233.45 15.2562C235.321 17.3751 236.256 20.4324 236.256 24.4281V43.7103H228.743V26.7589C228.743 24.1557 228.291 22.2587 227.385 21.0681C226.5 19.8573 225.112 19.2519 223.221 19.2519C221.17 19.2519 219.651 19.8573 218.665 21.0681C217.7 22.2587 217.217 24.1153 217.217 26.6378V43.7103H209.673Z" />
          <path d="M248.667 44.4368C246.213 44.4368 244.372 43.7607 243.145 42.4086C241.918 41.0566 241.304 39.0386 241.304 36.3546V19.4032H236.809V12.7741H241.304V3.60216L248.788 0V12.7741H255.788V19.4032H248.788V34.9924C248.788 35.9611 248.979 36.6775 249.361 37.1416C249.763 37.6058 250.387 37.8378 251.232 37.8378C252.72 37.8378 254.35 37.3737 256.12 36.4454L255.245 43.0443C254.319 43.5085 253.314 43.8515 252.227 44.0735C251.141 44.3157 249.954 44.4368 248.667 44.4368Z" />
          <path d="M256.801 43.7103V37.9892L272.612 19.4941H257.948V12.7741H282.298V18.3438L266.547 36.96H282.238V43.7103H256.801Z" />
          <path d="M298.179 44.4368C295.222 44.4368 292.667 43.7708 290.515 42.4389C288.383 41.107 286.733 39.2303 285.566 36.8086C284.42 34.3668 283.846 31.5013 283.846 28.2119C283.846 24.8822 284.43 22.0065 285.596 19.5849C286.783 17.1632 288.443 15.3067 290.575 14.0151C292.728 12.7034 295.262 12.0476 298.179 12.0476C300.673 12.0476 302.936 12.5723 304.968 13.6216C307 14.671 308.619 16.2854 309.826 18.4649C311.033 20.6241 311.637 23.3787 311.637 26.7286C311.637 27.2533 311.616 27.8991 311.576 28.6659C311.556 29.4126 311.506 30.1694 311.425 30.9362H291.299C291.38 32.3488 291.702 33.5899 292.265 34.6595C292.848 35.7088 293.643 36.5261 294.649 37.1114C295.654 37.6966 296.841 37.9892 298.209 37.9892C299.678 37.9892 300.955 37.747 302.041 37.2627C303.128 36.7582 304.153 35.9611 305.119 34.8713L309.464 39.3816C308.136 40.8951 306.537 42.116 304.666 43.0443C302.796 43.9726 300.633 44.4368 298.179 44.4368ZM291.33 25.0335H304.334C304.234 23.6814 303.932 22.5211 303.429 21.5524C302.926 20.5636 302.222 19.8068 301.317 19.2822C300.412 18.7575 299.316 18.4951 298.028 18.4951C296.258 18.4951 294.749 19.04 293.502 20.1297C292.255 21.2195 291.531 22.8541 291.33 25.0335Z" />
          <path d="M314.417 43.7103V12.7741H321.96V15.7405C322.946 14.5096 324.123 13.5914 325.491 12.9859C326.879 12.3604 328.458 12.0476 330.228 12.0476C333.668 12.0476 336.323 13.1171 338.194 15.2562C340.065 17.3751 341 20.4324 341 24.4281V43.7103H333.487V26.7589C333.487 24.1557 333.034 22.2587 332.129 21.0681C331.244 19.8573 329.856 19.2519 327.965 19.2519C325.913 19.2519 324.394 19.8573 323.409 21.0681C322.443 22.2587 321.96 24.1153 321.96 26.6378V43.7103H314.417Z" />
        </svg>
        <div
          style={{ color: "#1e3f57", display: "flex", flexDirection: "column" }}
        >
          kreativer entwickler,
          <div style={{ display: "flex" }}>
            <span style={{ color: "#18aa99", marginRight: "12px" }}>
              digitaler tüftler
            </span>
            &
            <span style={{ color: "#fcba03", marginLeft: "12px" }}>
              öcher jong
            </span>
          </div>
        </div>
      </div>
    ),
    {
      ...size,
      fonts: [
        {
          name: "Instrument",
          data: await loadGoogleFont("Instrument+Serif"),
          style: "normal",
        },
      ],
    },
  );
}
